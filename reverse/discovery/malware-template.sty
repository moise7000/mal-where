% malware-template.sty
% Package pour standardiser l'analyse de malware - Style épuré
% Usage: \usepackage{malware-template}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{malware-template}[2024/12/04 Malware Analysis Template - Clean Style]

% Packages requis
\RequirePackage{xcolor}
\RequirePackage{listings}
\RequirePackage{graphicx}
\RequirePackage{enumitem}
\RequirePackage{booktabs}

% Configuration des couleurs (minimalistes)
\definecolor{codebackground}{RGB}{250,250,250}
\definecolor{commentgray}{RGB}{100,100,100}
\definecolor{keywordblack}{RGB}{0,0,0}
\definecolor{stringgray}{RGB}{80,80,80}
\definecolor{framegray}{RGB}{200,200,200}

% Configuration listings pour assembleur
\lstdefinestyle{asmstyle}{
    language=[x86masm]Assembler,
    backgroundcolor=\color{codebackground},
    commentstyle=\color{commentgray}\itshape,
    keywordstyle=\color{keywordblack}\bfseries,
    stringstyle=\color{stringgray},
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    rulecolor=\color{framegray},
    numbers=left,
    numberstyle=\tiny\color{gray},
    showstringspaces=false,
    tabsize=4,
    xleftmargin=10pt,
    framexleftmargin=8pt,
    escapechar=@
}

% Configuration listings pour C
\lstdefinestyle{cstyle}{
    language=C,
    backgroundcolor=\color{codebackground},
    commentstyle=\color{commentgray}\itshape,
    keywordstyle=\color{keywordblack}\bfseries,
    stringstyle=\color{stringgray},
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    rulecolor=\color{framegray},
    numbers=left,
    numberstyle=\tiny\color{gray},
    showstringspaces=false,
    tabsize=4,
    xleftmargin=10pt,
    framexleftmargin=8pt,
    escapechar=@
}

% Configuration listings pour Python
\lstdefinestyle{pythonstyle}{
    language=Python,
    backgroundcolor=\color{codebackground},
    commentstyle=\color{commentgray}\itshape,
    keywordstyle=\color{keywordblack}\bfseries,
    stringstyle=\color{stringgray},
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    rulecolor=\color{framegray},
    numbers=left,
    numberstyle=\tiny\color{gray},
    showstringspaces=false,
    tabsize=4,
    xleftmargin=10pt,
    framexleftmargin=8pt,
    escapechar=@
}

% Environnements pour le code
\lstnewenvironment{asmcode}
{\lstset{style=asmstyle}}
{}

\lstnewenvironment{ccode}
{\lstset{style=cstyle}}
{}

\lstnewenvironment{pythoncode}
{\lstset{style=pythonstyle}}
{}

% Compteur pour les découvertes


% Commande de découverte épurée (sans tcolorbox, style minimaliste)
\newcommand{\discoverystart}[5]{%

    \section*{#1}

    \noindent\textbf{Localisation:} \texttt{#2} \quad
    \textbf{Fonction:} \texttt{\detokenize{#3}} \\
    \textbf{Type:} #4 \quad
    \textbf{Sévérité:} #5

    \vspace{0.3cm}
}

\newcommand{\discoveryanalysis}[1]{%
    \subsubsection*{Analyse}
    #1
    \vspace{0.2cm}
}

\newcommand{\discoveryscreenshot}[1]{%
    \subsubsection*{Screenshot}
    \noindent
    \includegraphics[width=0.9\textwidth]{#1}
    \par
    \vspace{0.2cm}
}

\newcommand{\discoveryiocs}{%
    \subsubsection*{IOC}
    \begin{itemize}[leftmargin=1.5em,itemsep=0.1em]
}

\newcommand{\discoverynotes}[1]{%
    \subsubsection*{Notes}
    #1
    \vspace{0.2cm}
}

\newcommand{\discoveryend}{%
    \end{itemize}
    \vspace{0.5cm}
}

% Configuration des sections sans numérotation
\RequirePackage{titlesec}

\titleformat{\section}
{\normalfont\Large\bfseries}
{}
{0em}
{}

\titleformat{\subsection}
{\normalfont\large\bfseries}
{}
{0em}
{}

\titleformat{\subsubsection}
{\normalfont\normalsize\bfseries}
{}
{0em}
{}

\endinput